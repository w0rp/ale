"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const PreprocessorParser_1 = require("./PreprocessorParser");
const Parser_spec_1 = require("../parser/tests/Parser.spec");
const TokenKind_1 = require("../lexer/TokenKind");
const chai_1 = require("chai");
describe('preprocessor parser', () => {
    let parser;
    beforeEach(() => {
        parser = new PreprocessorParser_1.PreprocessorParser();
    });
    it('parses chunks of brightscript', () => {
        let { chunks, diagnostics } = parser.parse([
            Parser_spec_1.identifier('someFunction'),
            Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
            Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
            Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
            Parser_spec_1.token(TokenKind_1.TokenKind.Eof, '\0')
        ]);
        chai_1.expect(diagnostics).to.eql([]);
        chai_1.expect(chunks[0].tokens.map(x => x.kind)).to.eql([
            TokenKind_1.TokenKind.Identifier,
            TokenKind_1.TokenKind.LeftParen,
            TokenKind_1.TokenKind.RightParen,
            TokenKind_1.TokenKind.Newline
        ]);
    });
    it('parses #const', () => {
        let { chunks, diagnostics } = parser.parse([
            Parser_spec_1.token(TokenKind_1.TokenKind.HashConst, '#const'),
            Parser_spec_1.identifier('foo'),
            Parser_spec_1.token(TokenKind_1.TokenKind.Equal, '='),
            Parser_spec_1.token(TokenKind_1.TokenKind.True, 'true'),
            Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
            Parser_spec_1.token(TokenKind_1.TokenKind.Eof, '\0')
        ]);
        chai_1.expect(diagnostics).to.be.empty;
        chai_1.expect(chunks).to.exist;
    });
    it('parses #error', () => {
        let { chunks, diagnostics } = parser.parse([
            Parser_spec_1.token(TokenKind_1.TokenKind.HashError, '#error'),
            Parser_spec_1.token(TokenKind_1.TokenKind.HashErrorMessage, 'I\'m an error message!'),
            Parser_spec_1.token(TokenKind_1.TokenKind.Eof, '\0')
        ]);
        chai_1.expect(diagnostics).to.eql([]);
        chai_1.expect(chunks).to.exist;
    });
    describe('conditionals', () => {
        it('#if only', () => {
            let { chunks, diagnostics } = parser.parse([
                Parser_spec_1.token(TokenKind_1.TokenKind.HashIf, '#if'),
                Parser_spec_1.identifier('foo'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.identifier('fooIsTrue'),
                Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
                Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.token(TokenKind_1.TokenKind.HashEndIf, '#endif'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Eof, '\0')
            ]);
            chai_1.expect(diagnostics).to.eql([]);
            chai_1.expect(chunks).to.exist;
        });
        it('#if and #else', () => {
            let { chunks, diagnostics } = parser.parse([
                Parser_spec_1.token(TokenKind_1.TokenKind.HashIf, '#if'),
                Parser_spec_1.identifier('foo'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.identifier('fooIsTrue'),
                Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
                Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.token(TokenKind_1.TokenKind.HashElse, '#else'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.identifier('fooIsFalse'),
                Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
                Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.token(TokenKind_1.TokenKind.HashEndIf, '#endif'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Eof, '\0')
            ]);
            chai_1.expect(diagnostics).to.eql([]);
            chai_1.expect(chunks).to.exist;
        });
        it('#if #else if and #else', () => {
            let { chunks, diagnostics } = parser.parse([
                Parser_spec_1.token(TokenKind_1.TokenKind.HashIf, '#if'),
                Parser_spec_1.identifier('foo'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.identifier('fooIsTrue'),
                Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
                Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.token(TokenKind_1.TokenKind.HashElseIf, '#elseif'),
                Parser_spec_1.identifier('bar'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.identifier('bar'),
                Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
                Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.token(TokenKind_1.TokenKind.HashElse, '#else'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.identifier('neither'),
                Parser_spec_1.token(TokenKind_1.TokenKind.LeftParen, '('),
                Parser_spec_1.token(TokenKind_1.TokenKind.RightParen, ')'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Newline, '\n'),
                Parser_spec_1.token(TokenKind_1.TokenKind.HashEndIf, '#endif'),
                Parser_spec_1.token(TokenKind_1.TokenKind.Eof, '\0')
            ]);
            chai_1.expect(diagnostics).to.eql([]);
            chai_1.expect(chunks).to.exist;
        });
    });
});
//# sourceMappingURL=PreprocessorParser.spec.js.map